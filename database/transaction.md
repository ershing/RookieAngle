# 数据库中的事务
###### 我的菜鸟仓库地址： [点击跳转查看其他相关文章](https://github.com/ershing/RookieAngle "菜鸟仓库")
###### 文章在我的博客上的地址： [点击跳转](http://www.ershing.cn/transaction/ "点击我")

        在数据库中，事务就是一个执行操作的工作单元。说得简单点，就是一个包含多个数据库操作的任务。例如，你先查这个表数据，然后再删那个表数据，再去创建一个新数据，这样的一系列的操作组成一个事务来管理。

        事务有四个标准属性：ACID。就是：原子性（Atomicity）、一致性（Consistency)、隔离性（Isolation）、持久性（Durability）。

        其实我不太喜欢太多的名词，在我看来，事务就是可以让你这些操作均成功完成，若其中一个操作发生错误，则全部回滚到最初状态。

        关于这个事务处理，基于它的特点，所以有一个很重要的特征，就是事务中的每个sql语句是不会立即提交（COMMIT）的，只会当你需要提交的时候，或者结束事务的时候才统一提交（COMMIT）的。

        举一个简单的例子，我在使用SQLite（SQLite是一个轻量级的数据库，无需建立数据库连接，只需引入数据文件即可）的时候遇到了一个问题，我在一个服务器运行之前，需要检测一下数据库中的区域信息，也就是所有的省市区的常规信息的时候，执行一个sql文件（这个区域信息可以参考这个文件：[区域信息](https://github.com/ershing/RookieAngle/blob/master/database/area.sql)）中的语句，发觉很慢，超级慢，打开SQLite Expert Pro（一款数据库可视化工具）观察，等了很久很久，然后点击一下，就崩了，发觉这样执行完全不行啊。然后用可视化工具直接复制语句进去执行，等了很久出来了部分数据，然后报错了。

        最后就找到需要用事务处理这种办法，因为sql语句中有好几千条数据，如果每读取一条执行语句都要commit一下，那么这段语句就要commit几千次了，对数据库的负担是很大的，虽然这种做法在MySQL中可以很快就完成了，但是在SQLite这种轻量级的数据库中却不是一件容易的事情，所以我在所有语句的前面加入语句：
```sql
BEGIN TRANSACTION;
        然后在所有语句最后加入语句：
```
```sql
END TRANSACTION;   # 或者COMMIT;
```
        这样就将整段语句作为事务来处理了，然后执行的时候就一瞬间就插入到数据库中了，所以数据库中的事务是非常有用的。